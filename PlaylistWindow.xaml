<Window x:Class="SlideShowBob.PlaylistWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:scm="clr-namespace:System.ComponentModel;assembly=WindowsBase"
        xmlns:local="clr-namespace:SlideShowBob"
        Title="Playlist"
        Height="450"
        Width="720"
        WindowStartupLocation="CenterOwner"
        Background="{DynamicResource WindowBackgroundBrush}"
        Foreground="{DynamicResource TextPrimaryBrush}"
        FontFamily="Segoe UI Variable"
        ResizeMode="CanResize"
        WindowStyle="SingleBorderWindow">

    <Window.Resources>
        <!-- ===== Fluent 2 / Windows 11 Modern Color Palette ===== -->
        <SolidColorBrush x:Key="WindowBackgroundBrush" Color="#0F0F0F"/>
        <SolidColorBrush x:Key="SurfaceBrush" Color="#1C1C1C"/>
        <SolidColorBrush x:Key="SurfaceAltBrush" Color="#242424"/>
        <SolidColorBrush x:Key="AccentBrush" Color="#0078D4"/>
        <SolidColorBrush x:Key="AccentBrushHover" Color="#106EBE"/>
        <SolidColorBrush x:Key="SubtleBorderBrush" Color="#2A2A2A"/>
        <SolidColorBrush x:Key="SubtleBorderStrongBrush" Color="#3A3A3A"/>
        <SolidColorBrush x:Key="TextPrimaryBrush" Color="#FFFFFF"/>
        <SolidColorBrush x:Key="TextSecondaryBrush" Color="#CCCCCC"/>
        <SolidColorBrush x:Key="TextMutedBrush" Color="#999999"/>
        <SolidColorBrush x:Key="ControlBackgroundHoverBrush" Color="#2A2A2A"/>
        <SolidColorBrush x:Key="ControlBackgroundPressedBrush" Color="#333333"/>

        <!-- Global text style -->
        <Style TargetType="TextBlock">
            <Setter Property="Foreground" Value="{StaticResource TextPrimaryBrush}"/>
            <Setter Property="TextOptions.TextFormattingMode" Value="Ideal"/>
            <Setter Property="FontFamily" Value="Segoe UI Variable"/>
        </Style>

        <!-- Common, readable list text -->
        <Style x:Key="ListTextStyle" TargetType="TextBlock">
            <Setter Property="Foreground" Value="{StaticResource TextPrimaryBrush}"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="TextTrimming" Value="CharacterEllipsis"/>
        </Style>

        <!-- Minimal GroupBox style -->
        <Style TargetType="GroupBox">
            <Setter Property="BorderBrush" Value="Transparent"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Margin" Value="0"/>
            <Setter Property="Padding" Value="0"/>
            <Setter Property="HeaderTemplate">
                <Setter.Value>
                    <DataTemplate>
                        <TextBlock Text="{Binding}"
                                   Foreground="{StaticResource TextSecondaryBrush}"
                                   FontSize="11"
                                   FontWeight="SemiBold"
                                   Margin="0,0,0,8"
                                   TextWrapping="NoWrap"/>
                    </DataTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Duration converter -->
        <local:DurationConverter x:Key="DurationConverter"/>

        <!-- CollectionViewSource for sorting media items -->
        <CollectionViewSource x:Key="MediaItemsViewSource">
            <CollectionViewSource.SortDescriptions>
                <scm:SortDescription PropertyName="Name" Direction="Ascending"/>
            </CollectionViewSource.SortDescriptions>
        </CollectionViewSource>

        <!-- View Mode Button Style (Segmented Control / Pill Toggle) -->
        <Style x:Key="ViewModeButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="{StaticResource SurfaceBrush}"/>
            <Setter Property="Foreground" Value="{StaticResource TextSecondaryBrush}"/>
            <Setter Property="BorderBrush" Value="{StaticResource SubtleBorderBrush}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="FontSize" Value="10"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="MinHeight" Value="24"/>
            <Setter Property="Padding" Value="8,3"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="Root"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="4"
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center"
                                            VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="Root" Property="Background" Value="{StaticResource ControlBackgroundHoverBrush}"/>
                                <Setter Property="Foreground" Value="{StaticResource TextPrimaryBrush}"/>
                            </Trigger>
                            <Trigger Property="Tag" Value="Selected">
                                <Setter TargetName="Root" Property="Background" Value="{StaticResource AccentBrush}"/>
                                <Setter Property="Foreground" Value="White"/>
                                <Setter TargetName="Root" Property="BorderBrush" Value="{StaticResource AccentBrush}"/>
                            </Trigger>
                            <MultiTrigger>
                                <MultiTrigger.Conditions>
                                    <Condition Property="Tag" Value="Selected"/>
                                    <Condition Property="IsMouseOver" Value="True"/>
                                </MultiTrigger.Conditions>
                                <Setter TargetName="Root" Property="Background" Value="{StaticResource AccentBrushHover}"/>
                                <Setter TargetName="Root" Property="BorderBrush" Value="{StaticResource AccentBrushHover}"/>
                            </MultiTrigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Modern minimalistic scrollbar style -->
        <Style TargetType="ScrollBar">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Width" Value="8"/>
            <Setter Property="MinWidth" Value="8"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ScrollBar">
                        <Grid x:Name="GridRoot" Background="Transparent">
                            <Track x:Name="PART_Track" IsDirectionReversed="False" Focusable="False">
                                <Track.Thumb>
                                    <Thumb x:Name="Thumb" Background="{StaticResource SubtleBorderBrush}" 
                                           BorderThickness="0" Margin="2,0">
                                        <Thumb.Style>
                                            <Style TargetType="Thumb">
                                                <Setter Property="Background" Value="{StaticResource SubtleBorderBrush}"/>
                                                <Setter Property="Template">
                                                    <Setter.Value>
                                                        <ControlTemplate TargetType="Thumb">
                                                            <Border Background="{TemplateBinding Background}" 
                                                                    CornerRadius="4" 
                                                                    Opacity="0.4"/>
                                                            <ControlTemplate.Triggers>
                                                                <Trigger Property="IsMouseOver" Value="True">
                                                                    <Setter Property="Opacity" Value="0.7"/>
                                                                </Trigger>
                                                                <Trigger Property="IsDragging" Value="True">
                                                                    <Setter Property="Opacity" Value="0.9"/>
                                                                </Trigger>
                                                            </ControlTemplate.Triggers>
                                                        </ControlTemplate>
                                                    </Setter.Value>
                                                </Setter>
                                            </Style>
                                        </Thumb.Style>
                                    </Thumb>
                                </Track.Thumb>
                            </Track>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Modern Button Style -->
        <Style x:Key="ModernButtonStyle" TargetType="Button">
            <Setter Property="Foreground" Value="{StaticResource TextPrimaryBrush}"/>
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="10,5"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="FontSize" Value="11"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="Root"
                                Background="{TemplateBinding Background}"
                                CornerRadius="4"
                                SnapsToDevicePixels="True">
                            <ContentPresenter HorizontalAlignment="Center"
                                            VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="Root" Property="Background"
                                        Value="{StaticResource ControlBackgroundHoverBrush}"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="Root" Property="Background"
                                        Value="{StaticResource ControlBackgroundPressedBrush}"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>

    <Grid Margin="12" Background="{StaticResource WindowBackgroundBrush}">
        <Grid.RowDefinitions>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- MAIN AREA -->
        <Grid Grid.Row="0" Margin="0,0,0,4">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <!-- FOLDER TREE -->
            <GroupBox Header="Folders in playlist"
                      Grid.Column="0"
                      Margin="0,0,8,0">
                <Border BorderBrush="{StaticResource SubtleBorderBrush}"
                        BorderThickness="1"
                        Background="{StaticResource SurfaceBrush}"
                        CornerRadius="4"
                        Padding="4">
                    <TreeView x:Name="FolderTree"
                             Background="Transparent"
                             BorderThickness="0"
                             Foreground="{StaticResource TextPrimaryBrush}"
                             SelectedItemChanged="FolderTree_SelectedItemChanged">
                        <TreeView.ItemContainerStyle>
                            <Style TargetType="TreeViewItem">
                                <Setter Property="Foreground" Value="{StaticResource TextPrimaryBrush}"/>
                                <Setter Property="Background" Value="Transparent"/>
                                <Setter Property="BorderThickness" Value="0"/>
                                <Setter Property="Padding" Value="3,1"/>
                                <Setter Property="Margin" Value="0"/>
                                <Style.Resources>
                                    <SolidColorBrush x:Key="{x:Static SystemColors.HighlightBrushKey}" Color="Transparent"/>
                                    <SolidColorBrush x:Key="{x:Static SystemColors.HighlightTextBrushKey}" Color="{StaticResource TextPrimaryBrush}"/>
                                </Style.Resources>
                                <Style.Triggers>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter Property="Background" Value="{StaticResource ControlBackgroundHoverBrush}"/>
                                    </Trigger>
                                    <Trigger Property="IsSelected" Value="True">
                                        <Setter Property="Background" Value="{StaticResource AccentBrush}"/>
                                        <Setter Property="Foreground" Value="White"/>
                                    </Trigger>
                                </Style.Triggers>
                            </Style>
                        </TreeView.ItemContainerStyle>
                        <TreeView.ItemTemplate>
                            <HierarchicalDataTemplate ItemsSource="{Binding Children}">
                                <TextBlock Text="{Binding Name}"
                                           Foreground="{StaticResource TextPrimaryBrush}"
                                           FontSize="12"
                                           TextTrimming="CharacterEllipsis"
                                           ToolTip="{Binding FullPath}"/>
                            </HierarchicalDataTemplate>
                        </TreeView.ItemTemplate>

                        <TreeView.ContextMenu>
                            <ContextMenu Background="{StaticResource SurfaceBrush}"
                                       BorderBrush="{StaticResource SubtleBorderBrush}">
                                <MenuItem Header="Remove folder from playlist"
                                          Foreground="{StaticResource TextPrimaryBrush}"
                                          Click="RemoveFolderMenuItem_Click">
                                    <MenuItem.Style>
                                        <Style TargetType="MenuItem">
                                            <Setter Property="Background" Value="Transparent"/>
                                            <Style.Triggers>
                                                <Trigger Property="IsMouseOver" Value="True">
                                                    <Setter Property="Background" Value="{StaticResource ControlBackgroundHoverBrush}"/>
                                                </Trigger>
                                            </Style.Triggers>
                                        </Style>
                                    </MenuItem.Style>
                                </MenuItem>
                            </ContextMenu>
                        </TreeView.ContextMenu>
                    </TreeView>
                </Border>
            </GroupBox>

            <!-- FILE LIST FOR SELECTED FOLDER -->
            <Grid Grid.Column="1"
                  Margin="6,0,0,0">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                
                <!-- Header with View Mode Selector -->
                <Grid Grid.Row="0" Margin="0,0,0,2">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <TextBlock Text="Files in selected folder"
                               VerticalAlignment="Center"
                               Foreground="{StaticResource TextSecondaryBrush}"
                               FontSize="10"
                               FontWeight="SemiBold"/>
                    <!-- View Mode Selector -->
                    <StackPanel Grid.Column="1"
                                Orientation="Horizontal"
                                Margin="6,0,0,0">
                        <Button x:Name="ThumbnailViewButton"
                                Content="Thumbnail"
                                Padding="8,3"
                                Margin="0,0,1,0"
                                Click="ViewModeButton_Click"
                                Tag="Thumbnail"
                                Style="{StaticResource ViewModeButtonStyle}"/>
                        <Button x:Name="ListViewButton"
                                Content="List"
                                Padding="8,3"
                                Margin="0,0,1,0"
                                Click="ViewModeButton_Click"
                                Tag="List"
                                Style="{StaticResource ViewModeButtonStyle}"/>
                        <Button x:Name="DetailedViewButton"
                                Content="Detailed"
                                Padding="8,3"
                                Click="ViewModeButton_Click"
                                Tag="Detailed"
                                Style="{StaticResource ViewModeButtonStyle}"/>
                    </StackPanel>
                </Grid>
                
                <!-- File List Container -->
                <GroupBox Grid.Row="1"
                          Header=""
                          Padding="0">
                <Border BorderBrush="{StaticResource SubtleBorderBrush}"
                        BorderThickness="1"
                        Background="{StaticResource SurfaceBrush}"
                        CornerRadius="4"
                        Padding="4">
                    <Grid>
                        <!-- Thumbnail View -->
                        <ScrollViewer x:Name="ThumbnailViewContainer"
                                     Visibility="Collapsed"
                                     VerticalScrollBarVisibility="Auto"
                                     HorizontalScrollBarVisibility="Disabled"
                                     Background="Transparent">
                            <ItemsControl x:Name="ThumbnailViewControl">
                                <ItemsControl.ItemsPanel>
                                    <ItemsPanelTemplate>
                                        <WrapPanel Orientation="Horizontal"/>
                                    </ItemsPanelTemplate>
                                </ItemsControl.ItemsPanel>
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <Border Width="140"
                                                Height="140"
                                                Margin="3"
                                                BorderBrush="{StaticResource SubtleBorderBrush}"
                                                BorderThickness="1"
                                                Background="{StaticResource SurfaceAltBrush}"
                                                CornerRadius="4"
                                                Cursor="Hand"
                                                MouseLeftButtonUp="Thumbnail_MouseLeftButtonUp">
                                            <Border.Style>
                                                <Style TargetType="Border">
                                                    <Style.Triggers>
                                                        <Trigger Property="IsMouseOver" Value="True">
                                                            <Setter Property="BorderBrush" Value="{StaticResource AccentBrush}"/>
                                                            <Setter Property="Background" Value="{StaticResource SurfaceBrush}"/>
                                                        </Trigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </Border.Style>
                                            <Grid>
                                                <!-- Thumbnail Image Container -->
                                                <Viewbox Stretch="Uniform"
                                                         HorizontalAlignment="Center"
                                                         VerticalAlignment="Center"
                                                         MaxWidth="130"
                                                         MaxHeight="130">
                                                    <Image Source="{Binding Thumbnail}"
                                                           Stretch="None"
                                                           HorizontalAlignment="Center"
                                                           VerticalAlignment="Center">
                                                        <Image.Style>
                                                            <Style TargetType="Image">
                                                                <Setter Property="Visibility" Value="Visible"/>
                                                                <Style.Triggers>
                                                                    <DataTrigger Binding="{Binding Thumbnail}" Value="{x:Null}">
                                                                        <Setter Property="Visibility" Value="Collapsed"/>
                                                                    </DataTrigger>
                                                                </Style.Triggers>
                                                            </Style>
                                                        </Image.Style>
                                                    </Image>
                                                </Viewbox>
                                                
                                                <!-- Loading Placeholder -->
                                                <Border Background="{StaticResource SurfaceAltBrush}"
                                                        Visibility="Collapsed">
                                                    <Border.Style>
                                                        <Style TargetType="Border">
                                                            <Setter Property="Visibility" Value="Collapsed"/>
                                                            <Style.Triggers>
                                                                <DataTrigger Binding="{Binding Thumbnail}" Value="{x:Null}">
                                                                    <Setter Property="Visibility" Value="Visible"/>
                                                                </DataTrigger>
                                                            </Style.Triggers>
                                                        </Style>
                                                    </Border.Style>
                                                    <TextBlock Text="Loading..."
                                                               Foreground="{StaticResource TextMutedBrush}"
                                                               HorizontalAlignment="Center"
                                                               VerticalAlignment="Center"
                                                               FontSize="11"/>
                                                </Border>
                                                
                                                <!-- File Name Overlay -->
                                                <Border Background="#80000000"
                                                        VerticalAlignment="Bottom"
                                                        Height="24"
                                                        CornerRadius="0,0,4,4">
                                                    <TextBlock Text="{Binding Name}"
                                                               Foreground="{StaticResource TextPrimaryBrush}"
                                                               FontSize="9"
                                                               Margin="6,0"
                                                               TextTrimming="CharacterEllipsis"
                                                               TextWrapping="NoWrap"
                                                               HorizontalAlignment="Left"
                                                               VerticalAlignment="Center"/>
                                                </Border>
                                            </Grid>
                                        </Border>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                        </ScrollViewer>

                        <!-- List View -->
                        <ListBox x:Name="ListViewControl"
                                 Background="Transparent"
                                 BorderThickness="0"
                                 Foreground="{StaticResource TextPrimaryBrush}"
                                 HorizontalContentAlignment="Stretch"
                                 ScrollViewer.VerticalScrollBarVisibility="Auto"
                                 ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                                 VirtualizingStackPanel.IsVirtualizing="True"
                                 VirtualizingStackPanel.VirtualizationMode="Recycling"
                                 SelectionChanged="ListViewControl_SelectionChanged"
                                 MouseDoubleClick="ListViewControl_MouseDoubleClick"
                                 Visibility="Collapsed">
                            <ListBox.ItemContainerStyle>
                                <Style TargetType="ListBoxItem">
                                    <Setter Property="Background" Value="Transparent"/>
                                    <Setter Property="BorderThickness" Value="0"/>
                                    <Setter Property="Padding" Value="6,2"/>
                                    <Setter Property="Margin" Value="0"/>
                                    <Style.Resources>
                                        <SolidColorBrush x:Key="{x:Static SystemColors.HighlightBrushKey}" Color="Transparent"/>
                                    </Style.Resources>
                                    <Style.Triggers>
                                        <Trigger Property="IsMouseOver" Value="True">
                                            <Setter Property="Background" Value="{StaticResource ControlBackgroundHoverBrush}"/>
                                        </Trigger>
                                        <Trigger Property="IsSelected" Value="True">
                                            <Setter Property="Background" Value="{StaticResource AccentBrush}"/>
                                            <Setter Property="Foreground" Value="White"/>
                                        </Trigger>
                                    </Style.Triggers>
                                </Style>
                            </ListBox.ItemContainerStyle>
                            <ListBox.ItemTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{Binding Name}"
                                               Margin="0,1"
                                               Foreground="{StaticResource TextPrimaryBrush}"
                                               FontSize="11"
                                               TextTrimming="CharacterEllipsis"
                                               ToolTip="{Binding FullPath}"/>
                                </DataTemplate>
                            </ListBox.ItemTemplate>
                            <ListBox.ContextMenu>
                                <ContextMenu Background="{StaticResource SurfaceBrush}"
                                           BorderBrush="{StaticResource SubtleBorderBrush}">
                                    <MenuItem Header="Remove file from playlist"
                                              Foreground="{StaticResource TextPrimaryBrush}"
                                              Click="RemoveFileMenuItem_Click">
                                        <MenuItem.Style>
                                            <Style TargetType="MenuItem">
                                                <Setter Property="Background" Value="Transparent"/>
                                                <Style.Triggers>
                                                    <Trigger Property="IsMouseOver" Value="True">
                                                        <Setter Property="Background" Value="{StaticResource ControlBackgroundHoverBrush}"/>
                                                    </Trigger>
                                                </Style.Triggers>
                                            </Style>
                                        </MenuItem.Style>
                                    </MenuItem>
                                </ContextMenu>
                            </ListBox.ContextMenu>
                        </ListBox>

                        <!-- Detailed View -->
                        <ListView x:Name="DetailedViewControl"
                                 Background="Transparent"
                                 BorderThickness="0"
                                 Foreground="{StaticResource TextPrimaryBrush}"
                                 VirtualizingStackPanel.IsVirtualizing="True"
                                 VirtualizingStackPanel.VirtualizationMode="Recycling"
                                 SelectionChanged="DetailedViewControl_SelectionChanged"
                                 MouseDoubleClick="DetailedViewControl_MouseDoubleClick"
                                 Visibility="Visible">
                            <ListView.ItemContainerStyle>
                                <Style TargetType="ListViewItem">
                                    <Setter Property="Background" Value="Transparent"/>
                                    <Setter Property="BorderThickness" Value="0"/>
                                    <Setter Property="Padding" Value="4,1"/>
                                    <Setter Property="Margin" Value="0"/>
                                    <Style.Resources>
                                        <SolidColorBrush x:Key="{x:Static SystemColors.HighlightBrushKey}" Color="Transparent"/>
                                    </Style.Resources>
                                    <Style.Triggers>
                                        <Trigger Property="IsMouseOver" Value="True">
                                            <Setter Property="Background" Value="{StaticResource ControlBackgroundHoverBrush}"/>
                                        </Trigger>
                                        <Trigger Property="IsSelected" Value="True">
                                            <Setter Property="Background" Value="{StaticResource AccentBrush}"/>
                                            <Setter Property="Foreground" Value="White"/>
                                        </Trigger>
                                    </Style.Triggers>
                                </Style>
                            </ListView.ItemContainerStyle>
                            <ListView.View>
                                <GridView>
                                    <GridViewColumn Header="File Name" Width="200">
                                        <GridViewColumn.HeaderContainerStyle>
                                        <Style TargetType="GridViewColumnHeader">
                                            <Setter Property="Foreground" Value="{StaticResource TextSecondaryBrush}"/>
                                            <Setter Property="Background" Value="Transparent"/>
                                            <Setter Property="BorderBrush" Value="{StaticResource SubtleBorderBrush}"/>
                                            <Setter Property="BorderThickness" Value="0,0,1,0"/>
                                            <Setter Property="Padding" Value="6,4"/>
                                            <Setter Property="HorizontalContentAlignment" Value="Left"/>
                                            <Setter Property="FontWeight" Value="SemiBold"/>
                                            <Setter Property="FontSize" Value="10"/>
                                            <Setter Property="Cursor" Value="Hand"/>
                                            <EventSetter Event="Click" Handler="ColumnHeader_Click"/>
                                            <Style.Triggers>
                                                <Trigger Property="IsMouseOver" Value="True">
                                                    <Setter Property="Foreground" Value="{StaticResource TextPrimaryBrush}"/>
                                                    <Setter Property="Background" Value="{StaticResource ControlBackgroundHoverBrush}"/>
                                                </Trigger>
                                            </Style.Triggers>
                                        </Style>
                                        </GridViewColumn.HeaderContainerStyle>
                                        <GridViewColumn.CellTemplate>
                                            <DataTemplate>
                                                <TextBlock Text="{Binding Name}"
                                                           Margin="4,2"
                                                           Style="{StaticResource ListTextStyle}"
                                                           ToolTip="{Binding FullPath}"/>
                                            </DataTemplate>
                                        </GridViewColumn.CellTemplate>
                                    </GridViewColumn>
                                    <GridViewColumn Header="File Type" Width="120">
                                        <GridViewColumn.HeaderContainerStyle>
                                        <Style TargetType="GridViewColumnHeader">
                                            <Setter Property="Foreground" Value="{StaticResource TextSecondaryBrush}"/>
                                            <Setter Property="Background" Value="Transparent"/>
                                            <Setter Property="BorderBrush" Value="{StaticResource SubtleBorderBrush}"/>
                                            <Setter Property="BorderThickness" Value="0,0,1,0"/>
                                            <Setter Property="Padding" Value="6,4"/>
                                            <Setter Property="HorizontalContentAlignment" Value="Left"/>
                                            <Setter Property="FontWeight" Value="SemiBold"/>
                                            <Setter Property="FontSize" Value="10"/>
                                            <Setter Property="Cursor" Value="Hand"/>
                                            <EventSetter Event="Click" Handler="ColumnHeader_Click"/>
                                            <Style.Triggers>
                                                <Trigger Property="IsMouseOver" Value="True">
                                                    <Setter Property="Foreground" Value="{StaticResource TextPrimaryBrush}"/>
                                                    <Setter Property="Background" Value="{StaticResource ControlBackgroundHoverBrush}"/>
                                                </Trigger>
                                            </Style.Triggers>
                                        </Style>
                                        </GridViewColumn.HeaderContainerStyle>
                                        <GridViewColumn.CellTemplate>
                                            <DataTemplate>
                                                <TextBlock Text="{Binding FileType}"
                                                           Margin="6,2"
                                                           Foreground="{StaticResource TextPrimaryBrush}"
                                                           FontSize="11"/>
                                            </DataTemplate>
                                        </GridViewColumn.CellTemplate>
                                    </GridViewColumn>
                                    <GridViewColumn Header="Duration" Width="100">
                                        <GridViewColumn.HeaderContainerStyle>
                                        <Style TargetType="GridViewColumnHeader">
                                            <Setter Property="Foreground" Value="{StaticResource TextSecondaryBrush}"/>
                                            <Setter Property="Background" Value="Transparent"/>
                                            <Setter Property="BorderBrush" Value="{StaticResource SubtleBorderBrush}"/>
                                            <Setter Property="BorderThickness" Value="0,0,1,0"/>
                                            <Setter Property="Padding" Value="6,4"/>
                                            <Setter Property="HorizontalContentAlignment" Value="Left"/>
                                            <Setter Property="FontWeight" Value="SemiBold"/>
                                            <Setter Property="FontSize" Value="10"/>
                                            <Setter Property="Cursor" Value="Hand"/>
                                            <EventSetter Event="Click" Handler="ColumnHeader_Click"/>
                                            <Style.Triggers>
                                                <Trigger Property="IsMouseOver" Value="True">
                                                    <Setter Property="Foreground" Value="{StaticResource TextPrimaryBrush}"/>
                                                    <Setter Property="Background" Value="{StaticResource ControlBackgroundHoverBrush}"/>
                                                </Trigger>
                                            </Style.Triggers>
                                        </Style>
                                        </GridViewColumn.HeaderContainerStyle>
                                        <GridViewColumn.CellTemplate>
                                            <DataTemplate>
                                                <TextBlock Text="{Binding Duration, Converter={StaticResource DurationConverter}}"
                                                           Margin="6,2"
                                                           Foreground="{StaticResource TextPrimaryBrush}"
                                                           FontSize="11"/>
                                            </DataTemplate>
                                        </GridViewColumn.CellTemplate>
                                    </GridViewColumn>
                                    <GridViewColumn Header="File Date" Width="150">
                                        <GridViewColumn.HeaderContainerStyle>
                                        <Style TargetType="GridViewColumnHeader">
                                            <Setter Property="Foreground" Value="{StaticResource TextSecondaryBrush}"/>
                                            <Setter Property="Background" Value="Transparent"/>
                                            <Setter Property="BorderBrush" Value="{StaticResource SubtleBorderBrush}"/>
                                            <Setter Property="BorderThickness" Value="0,0,1,0"/>
                                            <Setter Property="Padding" Value="6,4"/>
                                            <Setter Property="HorizontalContentAlignment" Value="Left"/>
                                            <Setter Property="FontWeight" Value="SemiBold"/>
                                            <Setter Property="FontSize" Value="10"/>
                                            <Setter Property="Cursor" Value="Hand"/>
                                            <EventSetter Event="Click" Handler="ColumnHeader_Click"/>
                                            <Style.Triggers>
                                                <Trigger Property="IsMouseOver" Value="True">
                                                    <Setter Property="Foreground" Value="{StaticResource TextPrimaryBrush}"/>
                                                    <Setter Property="Background" Value="{StaticResource ControlBackgroundHoverBrush}"/>
                                                </Trigger>
                                            </Style.Triggers>
                                        </Style>
                                        </GridViewColumn.HeaderContainerStyle>
                                        <GridViewColumn.CellTemplate>
                                            <DataTemplate>
                                                <TextBlock Margin="6,2"
                                                           Foreground="{StaticResource TextPrimaryBrush}"
                                                           FontSize="11">
                                                    <TextBlock.Text>
                                                        <Binding Path="FileDate" StringFormat="{}{0:g}"/>
                                                    </TextBlock.Text>
                                                </TextBlock>
                                            </DataTemplate>
                                        </GridViewColumn.CellTemplate>
                                    </GridViewColumn>
                                </GridView>
                            </ListView.View>
                            <ListView.ContextMenu>
                                <ContextMenu>
                                    <MenuItem Header="Remove file from playlist"
                                              Click="RemoveFileMenuItem_Click"/>
                                </ContextMenu>
                            </ListView.ContextMenu>
                        </ListView>
                    </Grid>
                </Border>
                </GroupBox>
            </Grid>
        </Grid>

        <!-- BOTTOM BUTTONS -->
        <StackPanel Grid.Row="1"
                    Orientation="Horizontal"
                    HorizontalAlignment="Right"
                    Margin="0,8,0,0">
            <Button x:Name="AddFolderButton"
                    Content="Add folder..."
                    MinWidth="90"
                    Padding="10,5"
                    Margin="0,0,6,0"
                    Click="AddFolderButton_Click"
                    Style="{StaticResource ModernButtonStyle}"/>
            <Button Content="Close"
                    MinWidth="70"
                    Padding="10,5"
                    IsCancel="True"
                    Click="CloseButton_Click"
                    Style="{StaticResource ModernButtonStyle}"/>
        </StackPanel>
    </Grid>
</Window>
